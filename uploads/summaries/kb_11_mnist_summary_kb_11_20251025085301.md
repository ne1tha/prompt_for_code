# 手写数字识别系统架构总结

## 主要目的
该文件实现了一个端到端的手写数字识别系统，包含模型训练、图像预处理、预测推理和交互式用户界面，用于识别本地图片中的手写数字（0-9）。

## 关键组件

### 1. `create_and_train_model()`
- **职责**：构建、训练并保存基于 CNN 的手写数字识别模型。
- **关键操作**：
  - 加载并预处理 MNIST 数据集（归一化、维度扩展、标签独热编码）。
  - 构建包含卷积层、池化层、Dropout 和全连接层的 `Sequential` 模型。
  - 使用 Adam 优化器和分类交叉熵损失进行训练。
  - 将训练好的模型保存为 `handwriting_model.h5`。

### 2. `preprocess_image(image_path)`
- **职责**：将用户提供的图片转换为模型可接受的输入格式。
- **关键操作**：
  - 读取并转换为灰度图，调整为 28×28 像素。
  - 自动检测并反转颜色（适配 MNIST 的白底黑字格式）。
  - 归一化像素值并添加批次与通道维度。

### 3. `predict_digit(model, image_path)`
- **职责**：使用预训练模型对单张图片进行预测。
- **关键操作**：
  - 调用 `preprocess_image` 处理输入。
  - 执行模型推理，返回预测数字、置信度及完整概率分布。

### 4. `main()`
- **职责**：协调整个流程并提供用户交互界面。
- **关键操作**：
  - 检查并加载现有模型，或触发训练流程。
  - 扫描当前目录中的图片文件供用户选择。
  - 调用预测函数并可视化结果（含 Matplotlib 显示）。

## 组件交互
- `main()` 作为入口，根据模型存在与否决定调用 `create_and_train_model()` 或直接加载模型。
- 用户选择图片后，`main()` 调用 `predict_digit()`，后者依赖 `preprocess_image()` 进行输入标准化。
- 预测结果由 `main()` 格式化输出，并可选地通过 `matplotlib` 可视化原始图像与预测结果。